USE MY_DB;

CREATE TABLE IF NOT EXISTS FLIGHT(
    FLIGHT_ID         VARCHAR(10) NOT NULL,
    DEPARTURE_AIRPORT   VARCHAR(3),
    ARRIVAL_AIRPORT     VARCHAR(3),
    DEPARTURE_TIME      DATETIME,
    ARRIVAL_TIME        DATETIME,
    AIRPLANE            VARCHAR(20),
    FARE                INT,
    PRIMARY KEY (FLIGHT_ID)
);

CREATE TABLE IF NOT EXISTS PASSENGER2(
    CNIC    BIGINT(13) NOT NULL,
    NATIONALITY     VARCHAR(20),
    NAME    VARCHAR(256),
    PHONE   DECIMAL(12,0),
    ADDRESS VARCHAR(256),
    PRIMARY KEY(CNIC, NATIONALITY)
);

CREATE TABLE IF NOT EXISTS PASSENGER1(
    P_ID            INT NOT NULL AUTO_INCREMENT,
    CNIC            BIGINT(13) NOT NULL,
    NATIONALITY     VARCHAR(20),
    PRIMARY KEY (P_ID),
    FOREIGN KEY(CNIC, NATIONALITY) 
        REFERENCES PASSENGER2(CNIC, NATIONALITY) ON UPDATE CASCADE ON DELETE CASCADE
);


CREATE TABLE IF NOT EXISTS TICKET(
    TICKET_ID       INT NOT NULL AUTO_INCREMENT,
    FLIGHT_ID       VARCHAR(10) NOT NULL,
    CNIC            BIGINT(13) NOT NULL,
    NATIONALITY     VARCHAR(20),
    PRIMARY KEY(TICKET_ID),
    FOREIGN KEY (CNIC, NATIONALITY) REFERENCES PASSENGER2(CNIC, NATIONALITY) ON UPDATE CASCADE ON DELETE CASCADE,
    FOREIGN KEY (FLIGHT_ID) REFERENCES FLIGHT(FLIGHT_ID) ON UPDATE CASCADE ON DELETE CASCADE
);

INSERT INTO FLIGHT(FLIGHT_ID, DEPARTURE_AIRPORT, ARRIVAL_AIRPORT, DEPARTURE_TIME, ARRIVAL_TIME, AIRPLANE, FARE)
VALUES
    ("PK101", "LHR", "KHI", "2019-12-24 10:20:00", "2019-12-24 11:30:00", "F-16", 13500),
    ("PK201", "LHR", "ABT", "2019-12-24 10:30:00", "2019-12-24 11:45:00", "F-RAPTOR", 10000),
    ("PK301", "LHR", "MTN", "2019-12-24 10:30:00", "2019-12-24 11:35:00", "F-DING", 7500),
    ("PK401", "LHR", "BWP", "2019-12-24 11:45:00", "2019-12-24 13:45:00", "G-F", 8700),
    ("PK501", "LHR", "KHI", "2019-12-24 12:00:00", "2019-12-24 15:00:00", "F-FAUJI", 15000),
    ("PK601", "BWP", "KHI", "2019-12-24 13:00:00", "2019-12-24 13:00:00", "F-GOLA", 6800),
    ("PK701", "MTN", "KHI", "2019-12-25 13:20:00", "2019-12-24 14:25:00", "F-BUMB", 6500),
    ("PK801", "BWP", "LHR", "2019-12-25 13:30:00", "2019-12-24 15:30:00", "F-TIYAARA", 7000),
    ("PK901", "FSD", "KHI", "2019-12-25 14:30:00", "2019-12-24 16:55:00", "F-HULK", 17000),
    ("PK111", "FSD", "LHR", "2019-12-25 15:00:00", "2019-12-24 16:00:00", "F-GG", 14000),
    ("PK121", "MTN", "KHI", "2019-12-25 20:00:00", "2019-12-24 21:00:00", "F-WP", 12000);

SET foreign_key_checks = 0;
INSERT INTO PASSENGER1(P_ID, CNIC, NATIONALITY)
VALUES
    (NULL, 3120283621890, "Pakistani" ),
    (NULL, 6120587611891, "Pakistani" ),
    (NULL, 8223287611892, "Pakistani" ),
    (NULL, 6520287611893, "Pakistani" ),
    (NULL, 3122287611894, "Pakistani" ),
    (NULL, 4120237611895, "Pakistani" ),
    (NULL, 3220287611896, "Pakistani" ),
    (NULL, 2123227611897, "Pakistani" ),
    (NULL, 1220287611898, "GOOCOUNTY" ),
    (NULL, 1220287611898, "AFRIIKIAN" ),
    (NULL, 4120287611810, "Pakistani" );

SET foreign_key_checks = 1;

INSERT INTO PASSENGER2(CNIC, NATIONALITY, NAME, PHONE, ADDRESS)
VALUES
    (3120283621890, "Pakistani",  "MAAA"  , 323457659883 , "IDHAR-UDHAR"),
    (6120587611891, "Pakistani",  "BACHA1" , 323457659883 , "IDHAR-UDHAR"),
    (8223287611892, "Pakistani",  "BACHA2", 323457659883 , "IDHAR-UDHAR"),
    (6520287611893, "Pakistani",  "GOLA-GANDA", 323457659883 , "JIDHA-UDHA"),
    (3122287611894, "Pakistani",  "MERA-ANDA" , 223457659883 , "AAO-JAO"),
    (4120237611895, "Pakistani",  "TERA-ANDA" , 123457659883 , "CHUCK220"),
    (3220287611896, "Pakistani",  "SSE-2021"  , 923423659883 , "332-DEFENSE"),
    (2123227611897, "Pakistani",  "SDSB-BOBO" , 923457659883 , "HOUSE8"),
    (1220287611898, "GOOCOUNTY",  "HSS_PITANG", 923432659883 , "HOUSE109"),
    (1220287611898, "AFRIIKIAN",  "GOOFYGANG" , 923457629283 , "HOMELESS"),
    (4120287611810, "Pakistani",  "GUCCIROS"  , 923457659883 , "BOOMBOOMAFRIDI KA HAMSAYE");

INSERT INTO TICKET(TICKET_ID, FLIGHT_ID, CNIC, NATIONALITY)
VALUES
    (NULL, "PK101", 3120283621890, "Pakistani"),
    (NULL, "PK101", 6120587611891, "Pakistani"),
    (NULL, "PK101", 8223287611892, "Pakistani"),
    (NULL, "PK401", 6520287611893, "Pakistani"),
    (NULL, "PK501", 3122287611894, "Pakistani"),
    (NULL, "PK601", 4120237611895, "Pakistani"),
    (NULL, "PK701", 3220287611896, "Pakistani"),
    (NULL, "PK801", 1220287611898, "AFRIIKIAN"),
    (NULL, "PK901", 4120287611810, "Pakistani"),
    (NULL, "PK111", 2123227611897, "Pakistani"),
    (NULL, "PK121", 1220287611898, "GOOCOUNTY");
